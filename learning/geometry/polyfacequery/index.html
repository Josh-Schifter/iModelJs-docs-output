<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Examples of &#x60;PolyfaceQuery&#x60; methods - iModel.js</title>
    <meta name="og:title" content="Examples of &#x60;PolyfaceQuery&#x60; methods - iModel.js">
    <meta name="twitter:title" content="Examples of &#x60;PolyfaceQuery&#x60; methods - iModel.js">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="https://imodeljs.github.io/iModelJs-docs-output//styles/bundle.css">

    <!-- bootstrap -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

    <!-- fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet"> 
    
    <link rel="stylesheet" type="text/css" href="https://imodeljs.github.io/iModelJs-docs-output//styles/devRegistration.css"> 
    
    <link rel="stylesheet" type="text/css" href="https://imodeljs.github.io/iModelJs-docs-output//styles/landingPage.css">  
        <link rel='shortcut icon' type='image/x-icon' href='https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/imodeljs_16.png' /> 
        <meta property="og:description" content="Create Immersive Connections with your Infrastructure Digital Twin."><meta property="og:url" content="imodeljs.org"><meta name="twitter:card" content="summary_large_image">
        <meta property="og:image" content="https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/twitter-share.png">
        <meta />
</head>

<body data-site-root=https://imodeljs.github.io/iModelJs-docs-output// class='layout-index '>
    <span id="contentLoader">
        <p>Woah! This page has a great deal of content... Give us a second to load it.</p>
    </span>
    <span id="contentLoaderBackground"></span>
    <div id="flex-wrapper">



        <header id="main-header">
            <div class='nav-header-container'>
                <nav class="navbar nav-main-header navbar-expand-md fixed-top navbar-light pb-0">
                    <a href="https://imodeljs.github.io/iModelJs-docs-output//" class="navbar-brand">
                            <img id="site-logo" class="site-logo" src="https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/imodeljs-logo.svg" /> 
                            <img id="site-logo-small" class="site-logo-small" src="https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/imodeljs-icon.svg" style="display:none;"/> 
                    </a>
                    <button class="navbar-toggler no-user-select mr-auto" type="button" data-toggle="collapse" data-target="#navbar5">
                        <span class="navbar-toggler-header"></span>
                    </button>
                    <ul class="navbar-nav ml-auto pr-0 nav-search">
                        <span class='search-bar'>
                          <li>
                            <div id='search-container'>
                            </div>
                          </li>
                          <script>
                            (function() {
                              var cx = '018053174497532353467:v_gnrjjlqwc';
                              var gcse = document.createElement('script');
                              gcse.type = 'text/javascript';
                              gcse.async = true;
                              gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                              var s = document.getElementsByTagName('script')[0];
                              s.parentNode.insertBefore(gcse, s);
                            })();
                          </script>
                          <gcse:searchresults-only gname="sitesearch" resultSetSize="7"></gcse:search>
                        </span>
                    </ul>
                    <div class="navbar-collapse collapse justify-content-stretch" id="navbar5">
                        <ul class="navbar-nav mb-0" id="doc-site-tabs">
                                <li class="nav-item "><a class="nav-link" href="https://imodeljs.github.io/iModelJs-docs-output//getting-started">Getting Started</a></li><li class="nav-item "><a class="nav-link" href="https://imodeljs.github.io/iModelJs-docs-output//bis">BIS</a></li><li class="nav-item active"><a class="nav-link" href="https://imodeljs.github.io/iModelJs-docs-output//learning">Learning</a></li><li class="nav-item "><a class="nav-link" href="https://imodeljs.github.io/iModelJs-docs-output//reference">API Reference</a></li><li class="nav-item change-history-tab "><a class="nav-link" href="https://imodeljs.github.io/iModelJs-docs-output//changehistory">v1.8.0</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </header>
<div id='main-wrapper'>
    <nav id='sidebar'>
        <div id='table-of-contents' class="custom-scrollbar">
            <div id="dismiss">
                <i id="dismiss-arrow" class="icon icon-chevron-left no-user-select"></i>
            </div>
            <hr id="dismiss-hr" class='sm-only'>
            <ul id='main-navigation-list'>
                <html><head></head><body><h3 id="the imodel.js library"><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/" class="table-of-contents-link">The iModel.js Library</a></h3>
    <ul>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/frontend/" class="table-of-contents-link">Frontend</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/backend/" class="table-of-contents-link">Backend</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/common/" class="table-of-contents-link">Common</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/geometry/" class="table-of-contents-link">Geometry</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/presentation/" class="table-of-contents-link">Presentation</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/ui/" class="table-of-contents-link">UI</a></li>
    </ul>
    <hr>
    <p>&#xA0;</p>
    <h3 id="helpful links">Helpful links</h3>
    <ul>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//./learning/ecsql" class="table-of-contents-link">ECSQL</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/imodelhub/" class="table-of-contents-link">iModelHub</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//./learning/wireformat" class="table-of-contents-link">Wire Format</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//./learning/faq" class="table-of-contents-link">Frequently Asked Questions</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/guidelines/" class="table-of-contents-link">Guidelines and Tips</a></li>
    <li><a href="https://imodeljs.github.io/iModelJs-docs-output//./learning/glossary" class="table-of-contents-link">Glossary</a></li>
    </ul>
    </body></html>
            </ul>
        </div>
    </nav>    <div class='documentation-main'>
        <article id="main" class="main-content">
            <button type="button" id="sidebarCollapse" class="no-user-select"> <i class="bread-crumb-label bread-crumb-expand-leftnav icon icon-chevron-right no-user-select" id="expand-leftnav"></i></button><div class='bread-crumb-label'><a href="https://imodeljs.github.io/iModelJs-docs-output//learning/">Learning</a> > <a href="https://imodeljs.github.io/iModelJs-docs-output//learning/geometry/">geometry</a> > PolyfaceQuery</div>
            <div class="edit-link"><a href="https://github.com/imodeljs/imodeljs/tree/master/docs/learning/geometry/PolyfaceQuery.md">Edit this page</a></div>
            <h1 id="examples of polyfacequery methods">Examples of <code>PolyfaceQuery</code> methods</h1>
<h2 class="h-partitioning-by-vertex-and-edge-connectivity">Partitioning by vertex and edge connectivity<a id="partitioning-by-vertex-and-edge-connectivity" class="heading-anchor" href="#partitioning-by-vertex-and-edge-connectivity"><span><i class="fa fa-link fa-rotate-90"></i></span></a></h2>
<table class="table table-responsive"><tbody><tr>
<th></th>
<th></th>
<th></th>
</tr>
<tr>
<td></td>
<td>A single mesh with 5 facets</td>
<td><img src=".././figs/PolyfaceQuery/PartitionByConnectivity/SingleMesh5Facets.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>create arrays of facet indices that share any vertex contact</td>
<td>const facetIndexArraysWithVertexConnectivity = PolyfaceQuery.partitionFacetIndicesByEdgeConnectedComponent(polyface)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>extract as separate meshes</td>
<td>const fragmentPolyfaces = PolyfaceQuery.clonePartitions(polyface, facetIndexArraysWithVertexConnectivity);</td>
<td></td>
</tr>
<tr>
<td></td>
<td>2 separate Polyface meshes (red, green), each with at least vertex-to-vertex connectivity</td>
<td><img src=".././figs/PolyfaceQuery/PartitionByConnectivity/SplitByVertexConnectivity.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>create arrays of facet indices that share an entire edge</td>
<td>const facetIndexArraysWithEdgeConnectivity = PolyfaceQuery.partitionFacetIndicesByEdgeConnectedComponent(polyface)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>extract as separate meshes</td>
<td>const fragmentPolyfaces = PolyfaceQuery.clonePartitions(polyface, facetIndexArraysWithEdgeConnectivity);</td>
<td></td>
</tr>
<tr>
<td></td>
<td>3 separate Polyface objects (blue, drab, magenta), each with at least edge-to-edge connectivity</td>
<td><img src=".././figs/PolyfaceQuery/PartitionByConnectivity/SplitByEdgeConnectivity.png" alt="&gt;"></td>
<td></td>
</tr>
</tbody></table><p>Unit Test</p>
<ul>
<li>source: imodeljs/core/geometry/src/test/clipping/PolyfaceQuery.test.ts</li>
<li>test name: &quot;PartitionFacetIndicesByConnectivity&quot;</li>
<li>output: imodeljs/core/geometry/src/test/output/PolyfaceQuery/PartitionFacetsByConnectivity.imjs</li>
</ul>
<h2 class="h-fixup-tvertices">Fixup TVertices<a id="fixup-tvertices" class="heading-anchor" href="#fixup-tvertices"><span><i class="fa fa-link fa-rotate-90"></i></span></a></h2>
<table class="table table-responsive"><tbody><tr>
<th></th>
<th></th>
<th></th>
</tr>
<tr>
<td></td>
<td>A mesh with 7 square facets. <br> Note that vertices from adjacent squares appear &quot;within&quot; some long edges.</td>
<td><img src=".././figs/PolyfaceQuery/TVertexFixup/AllQuadsShaded.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Skeletal display with circles near each vertex of each facet  <br> The circles indicate that each facet references only its actual corners <br> Red highlight shows &quot;TVertex&quot; situations</td>
<td><img src=".././figs/PolyfaceQuery/TVertexFixup/AllQuadsSectorMarkup.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>After calling <code>PolyfaceQuery.cloneWithTVertexFixup</code> the long edges that passed through the T-Vertex <br> have vertices inserted <br> The two larger &quot;squares&quot; now reference (left of center) 9 and (upper right) 6 vertices</td>
<td><img src=".././figs/PolyfaceQuery/TVertexFixup/FixupSectorMarkup.png" alt="&gt;"></td>
<td></td>
</tr>
</tbody></table><p>Unit Test</p>
<ul>
<li>source: imodeljs/core/geometry/src/test/clipping/PolyfaceQuery.test.ts</li>
<li>test name: &quot;cloneWithTVertexFixup&quot;</li>
<li>output: imodeljs/core/geometry/src/test/output/PolyfaceQuery/cloneWithTVertexFixup.imjs</li>
</ul>
<h2 class="h-fixup-colinear-edges">Fixup Colinear Edges<a id="fixup-colinear-edges" class="heading-anchor" href="#fixup-colinear-edges"><span><i class="fa fa-link fa-rotate-90"></i></span></a></h2>
<table class="table table-responsive"><tbody><tr>
<th></th>
<th></th>
<th></th>
</tr>
<tr>
<td></td>
<td>A mesh with 2 rectangular facets. <br> Note that along the long edges there are multiple interior vertices.</td>
<td><img src=".././figs/PolyfaceQuery/ColinearEdgeFixup/BeforeColinearEdgeFixup.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Skeletal display with circles indicating interior vertices within the facets.</td>
<td><img src=".././figs/PolyfaceQuery/ColinearEdgeFixup/SectorsBefore.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>After <code>PolyfaceQuery.cloneWithColinearEdgeFixup</code> <br> each rectangle only has 4 vertices</td>
<td><img src=".././figs/PolyfaceQuery/ColinearEdgeFixup/AfterColinearEdgeFixup.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Skeletal display with circles indicating interior vertices within the facets.</td>
<td><img src=".././figs/PolyfaceQuery/ColinearEdgeFixup/SectorsAfter.png" alt="&gt;"></td>
<td></td>
</tr>
</tbody></table><p>Note that colinearEdgeFixup and TVertexFixup have tricky interactions.  If colinearEdgeFixup is applied to the final figure (blue markup) of the TVertexFixup section (above), the locally colinear edges within the large rectangles are <em>not</em> removed.  This the colinear edge logic will notice that those vertices are incident to other facets where the vertex is a true corner, and hence should not be removed.</p>
<p>Unit Test</p>
<ul>
<li>source: imodeljs/core/geometry/src/test/clipping/PolyfaceQuery.test.ts</li>
<li>test name: &quot;cloneWithColinearEdgeFixup&quot;</li>
<li>output: imodeljs/core/geometry/src/test/output/PolyfaceQuery/cloneWithColinearEdgeFixup.imjs</li>
</ul>
<h2 class="h-mark-edge-visibility">Mark Edge Visibility<a id="mark-edge-visibility" class="heading-anchor" href="#mark-edge-visibility"><span><i class="fa fa-link fa-rotate-90"></i></span></a></h2>
<p>Each edge of each facet in a polyface has a visibility indicator.  This tells display engines whether that edge should be highlighted with a drawn line as the facet it displayed.
(Some display engines may choose to ignore this an always display just the shaded facet body.)</p>
<p>During default construction by a <code>PolyfaceBuilder</code> all edges are marked visible by default.</p>
<table class="table table-responsive"><tbody><tr>
<th></th>
<th></th>
<th></th>
</tr>
<tr>
<td></td>
<td>A (partial, capped) TorusPope with all edges visible</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeAllEdgesVisible.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Apply <code>PolyfaceQuery.markAllEdgeVisibility (mesh, false);</code> <br> this hides all edges.  <br> (The display engine has added some linework by silhouette rules)</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeAllEdgesNotVisible.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Apply <code>PolyfaceQuery.markPairedEdgesInvisible(mesh, Angle.createDegrees (0.1)));</code> <br> this hides edges with adjacent facet angle less than 0.1 degrees.  <br> (Hence only the edges within the flat caps are hidden)</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeHideInPlane.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Apply <code>PolyfaceQuery.markPairedEdgesInvisible(mesh, Angle.createDegrees (15)));</code> <br> this hides edges with adjacent facet angle less than 15 degrees.  <br> (Edges within the flat caps are hidden.   Visibility in the torus body varies.)</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeHide15.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Apply <code>PolyfaceQuery.markPairedEdgesInvisible(mesh, Angle.createDegrees (30)));</code> <br> this hides edges with adjacent facet angle less than 30 degrees.  <br> (Edges within the flat caps are hidden.   Visibility in the torus body varies.)</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeHide30.png" alt="&gt;"></td>
<td></td>
</tr>
<tr>
<td></td>
<td>Apply <code>PolyfaceQuery.markPairedEdgesInvisible(mesh, Angle.createDegrees (50)));</code> <br> this hides edges with adjacent facet angle less than 50 degrees.  <br> (Edges within the flat caps are hidden.   The only visible edges are at the 90 degree angles around the caps)</td>
<td><img src="./figs/PolyfaceQuery\EdgeVisibility\TorusPipeHide50.png" alt="&gt;"></td>
<td></td>
</tr>
</tbody></table><p>Unit Test</p>
<ul>
<li>source: imodeljs/core/geometry/src/test/clipping/Polyface.test.ts</li>
<li>test name: &quot;SolidPrimitiveBoundary&quot;</li>
<li>output: imodeljs/core/geometry/src/test/output/Polyface\SolidPrimitiveBoundary.imjs</li>
</ul>

            <p class='last-updated'>Last Updated:
                <span class='date-updated'>22 November, 2019</span>
            </p>
            <div id="imodeljs-github-comments">
            </div>
            
            <script>
              $(document).ready(function () {
                function initializeComments(repo) {
                  var s = document.createElement('script');
                  s.src = "https://imodeljs.github.io/iModelJs-docs-output//scripts/utterances/client.js";
                  s.setAttribute('repo', repo);
                  s.setAttribute('issue-term', 'title');
                  s.setAttribute('crossorigin', 'anonymous');
                  s.setAttribute('theme', 'github-light');
                  s.async = true;
            
                  document.getElementById("imodeljs-github-comments").appendChild(s);
                }
            
                var shouldShow = ldclient.variation(featureFlags.GithubIssuesFeedback);
            
                // shouldShow is undefined when ldclient has not emitted 'ready'.
                if (shouldShow === undefined) {
                  ldclient.on('ready', function () {
                    var gitIssueFlag = ldclient.variation(featureFlags.GithubIssuesFeedback);
                    var gitRepo = ldclient.variation(featureFlags.GitRepo);
                    if (gitIssueFlag) {
                      initializeComments(gitRepo);
                    }
                  });
                }
                else if (shouldShow) {
                  var gitRepo = ldclient.variation(featureFlags.GitRepo);
                  initializeComments(gitRepo);
                }
              });
            </script>
            
            <script type="text/javascript">
            
            </script>        </article>
    </div>
    <div class="toc-overlay"></div>
    <div id='inner-table-of-contents'>
       <!-- <div id='sticky-container' style="top: 76px; position: fixed;">
  <h4 class='heading'>On this page</h4>
    <div id="overview-container" class="clusterize-scroll">
      <ul id='nav' class='right-nav nav flex-column clusterize-content'>
              <li class='nav-item item '>
            <a class='title solo-title menu-text' href="#partitioning-by-vertex-and-edge-connectivity">Partitioning by vertex and edge connectivity</a>
    </li>
       <li class='nav-item item '>
            <a class='title solo-title menu-text' href="#fixup-tvertices">Fixup TVertices</a>
    </li>
       <li class='nav-item item '>
            <a class='title solo-title menu-text' href="#fixup-colinear-edges">Fixup Colinear Edges</a>
    </li>
       <li class='nav-item item '>
            <a class='title solo-title menu-text' href="#mark-edge-visibility">Mark Edge Visibility</a>
    </li>
 
      </ul>
    </div>
  </div>

 -->
    </div>
</div>

<!-- Footer -->
<footer class="page-footer font-small mdb-color pt-1 pb-3">
  <!-- Footer Links Container -->
  <div class="container text-center text-md-left">

    <!-- Grid row -->
    <div class="row d-flex align-items-center mt-2">

      <!-- Grid column -->
      <div class="col-md-7 col-lg-8 align-top d-none d-md-block">

        <a href="https://imodeljs.github.io/iModelJs-docs-output//" class="navbar-brand">
          <img id="site-logo" class="site-logo" style="zoom:75%;"
            src="https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/imodeljs-logo.svg" />
        </a>
        <small style="color: white; margin-right: 7px;"> powered by </small>
        <a href="https://www.bentley.com">
          <img href="https://www.bentley.com" id="sponsored-by-logo" class="sponsored-by-logo"
            style="zoom:75%; width: 162px; height: 37px;"
            src="https://imodeljs.github.io/iModelJs-docs-output//landing-page/assets/bentley.svg" />
        </a>
      </div>
      <!-- Grid column -->

      <!-- TOS/Legals footer placeholder -->
      <div id="HFRootHeader"></div>

      <!-- Grid column -->
      <div class="col-md-5 col-lg-4 ml-lg-0">

        <!-- Social buttons -->
        <div class="text-center text-md-right">
          <ul class="list-unstyled list-inline">
            <li class="list-inline-item">
              <a class="btn-floating btn-sm rgba-white-slight mx-1" href="https://twitter.com/imodeljs" target="_blank">
                <i class="fa fa-twitter"></i>
              </a>
            </li>
            </li>
            <li class="list-inline-item">
              <a class="btn-floating btn-sm rgba-white-slight mx-1" href="https://github.com/imodeljs" target="_blank">
                <i class="fa fa-github"></i>
              </a>
            </li>
            <li class="list-inline-item">
              <a class="btn-floating btn-sm rgba-white-slight mx-1" href="https://stackoverflow.com/tags/imodeljs"
                target="_blank">
                <i class="fa fa-stack-overflow"></i>
              </a>
            </li>
          </ul>
        </div>

      </div>
      <!-- Grid column -->

    </div>
    <!-- Grid row -->

  </div>
  <!-- Footer Links Container -->

</footer>
<!-- Footer -->

</div>
<a href="javascript:" id="return-to-top"><i class="icon icon-chevron-up"></i></a>
<script src="https://imodeljs.github.io/iModelJs-docs-output//scripts/bundle.js"></script>
</body>

</html>
<script src="https://imodeljs.github.io/iModelJs-docs-output//scripts/monaco-editor/min/vs/loader.js"></script>
<script src="https://imodeljs.github.io/iModelJs-docs-output//scripts/ts-playground.js"></script>
