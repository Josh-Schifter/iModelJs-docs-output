(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1064:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1);t.default=function(){o.Logger.initialize((e,t,n)=>console.log("Error: "+t+(n?" "+JSON.stringify(n()):"")),(e,t,n)=>console.log("Warning: "+t+(n?" "+JSON.stringify(n()):"")),(e,t,n)=>console.log("Info: "+t+(n?" "+JSON.stringify(n()):"")))}},1065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),i=n(1066);t.default=function(){const e=i.default();let t;const n={info:{title:"demo-viewer-backend",version:"v1.0"},uriPrefix:"https://connect-imodelsf.bentley.com/"};if(t=o.BentleyCloudRpcManager.initializeClient(n,e),o.RpcOperation.lookup(o.IModelTileRpcInterface,"getTileContent").policy.allowResponseCaching=(()=>o.RpcResponseCacheControl.None),void 0===n.uriPrefix||!n.uriPrefix.includes("connect-imodelsf.bentley.com"))for(const i of t.interfaces())o.RpcOperation.forEach(i,e=>e.policy.token=(e=>new o.IModelToken("test","test","test","test")));return t}},1066:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),i=n(32);t.default=function(){return[o.IModelReadRpcInterface,o.StandaloneIModelRpcInterface,o.IModelTileRpcInterface,i.PresentationRpcInterface]}},1067:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(92),s=n(74),a=n(1068);n(260),n(1084);const l=n(57),c=n(4),r={imodel:void 0,viewDefinitionId:void 0,accessToken:void 0};t.default=class App extends o.Component{constructor(e,t){super(e,t),this.state=r,this._rpcConfiguration=this.props.rpcConfig}componentDidMount(){s.Presentation.selection.selectionChange.addListener(this.onSelectionChanged),(async()=>{let e;try{const t="97a67f36-8efa-499c-a6ed-a8e07f38a410",n="998b4696-a672-4f85-bea1-8e35e0852452",o="93b6c5340d2cc99534afeb97d03227ce75c7734a",s=()=>fetch("https://prod-imodeldeveloperservices-eus.azurewebsites.net/api/v0/targetUser").then(e=>e.json()).catch(e=>{console.warn(e)}),a=await s(),d=l.AccessToken.fromSamlAssertion(a._samlAssertion),p=c.IModelVersion.asOfChangeSet(o);this._rpcConfiguration.applicationAuthorizationValue=d.toTokenString(),e=await i.IModelConnection.open(d,n,t,1,p),this.setState({imodel:e,accessToken:d})}catch(e){this.setState(r)}this.onIModelSelected(e)})()}componentWillUnmount(){s.Presentation.selection.selectionChange.removeListener(this.onSelectionChanged)}onSelectionChanged(e,t){const n=t.getSelection(e.imodel,e.level);n.isEmpty?console.log("========== Selection cleared ==========="):(console.log("========== Selection change ==========="),0!==n.instanceKeys.size&&(console.log("ECInstances:"),n.instanceKeys.forEach((e,t)=>{console.log(`${t}: [${[...e].join(",")}]`)})),0!==n.nodeKeys.size&&(console.log("Nodes:"),n.nodeKeys.forEach(e=>console.log(JSON.stringify(e)))),console.log("======================================="))}async getFirstViewDefinitionId(e){const t=["BisCore:SpatialViewDefinition","BisCore:DrawingViewDefinition"],n=(await e.views.queryProps({})).filter(e=>-1!==t.indexOf(e.classFullName));if(0===n.length)throw new Error("No valid view definitions in imodel");return n[0].id}async onIModelSelected(e){if(e)try{const t=e?await this.getFirstViewDefinitionId(e):void 0;this.setState({viewDefinitionId:t})}catch(t){e.close(this.state.accessToken),this.setState(r)}else this.setState(r)}renderIModelComponents(e,t){return o.createElement("div",{className:"Content"},o.createElement("div",{className:"top-left"},o.createElement(a.default,{imodel:e,rulesetId:"Default",viewDefinitionId:t})))}render(){let e;return this.state.imodel&&this.state.viewDefinitionId&&(e=this.renderIModelComponents(this.state.imodel,this.state.viewDefinitionId)),o.createElement("div",{className:"App"},e)}}},1068:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(88),s=n(1069),a=n(1082),l=n(1083),c=s.viewWithUnifiedSelection(i.ViewportComponent);t.default=class SimpleViewportComponent extends o.Component{render(){return o.createElement("div",null,o.createElement(c,{imodel:this.props.imodel,rulesetId:this.props.rulesetId,viewDefinitionId:this.props.viewDefinitionId}),o.createElement(a.default,null),o.createElement(l.default,null))}}},1082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(92);n(515);const s=()=>{const e=document.getElementsByClassName("toolbar")[0].getElementsByClassName("toolbar-button");for(let t=0;t<e.length;++t)e[t].classList.remove("active-button")},a=e=>{s(),"DIV"!==e.parentElement.tagName?e.parentElement.classList.add("active-button"):e.classList.add("active-button"),c()},l=()=>{const e=document.getElementsByClassName("active-bar");for(;e[0];)e[0].parentNode.removeChild(e[0])},c=()=>{l();const e=document.getElementsByClassName("toolbar")[0].getElementsByClassName("active-button")[0],t=document.createElement("div");t.className="active-bar",e.appendChild(t)},r=e=>{i.IModelApp.tools.run(i.ZoomViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},d=e=>{i.IModelApp.tools.run(i.PanViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},p=e=>{i.IModelApp.tools.run(i.RotateViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},u=()=>{s(),l(),i.IModelApp.tools.run(i.FitViewTool.toolId,i.IModelApp.viewManager.selectedView)},m=()=>{window.open(".")};t.default=(()=>{window.oncontextmenu=(()=>{s(),l()}),i.IModelApp.tools.unRegister("Select"),i.IModelApp.accuSnap.onNoMotion=(()=>{});const e=[];return window.frameElement&&e.push(o.createElement("a",{key:5,onClick:m,className:"toolbar-button a-full-screen"},o.createElement("span",{className:"icon icon-window-full-screen"}))),e.push(o.createElement("a",{key:1,onClick:u,className:"toolbar-button"},o.createElement("span",{className:"icon icon-fit-to-view"}))),e.push(o.createElement("a",{key:2,onClick:e=>r(e),className:"toolbar-button"},o.createElement("span",{className:"icon icon-zoom"}))),e.push(o.createElement("a",{key:3,onClick:e=>d(e),className:"toolbar-button"},o.createElement("span",{className:"icon icon-hand-2"}))),e.push(o.createElement("a",{key:4,onClick:e=>p(e),className:"toolbar-button"},o.createElement("span",{className:"icon icon-gyroscope"}))),o.createElement("div",{className:"toolbar"},e)})},1083:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0);n(515);t.default=(()=>{return o.createElement("img",{className:"imjs-watermark",src:"./assets/watermark-01.svg"})})},1084:function(e,t,n){},1085:function(e,t,n){},515:function(e,t,n){},521:function(e,t,n){n(522),e.exports=n(526)},526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=n(56),s=n(531),a=n(4),l=n(1067);n(1085),s.SimpleViewerApp.startup();s.SimpleViewerApp.viewManager.onViewOpen.addListener(async e=>{if(!e.view.is3d())return;e.view.viewFlags.renderMode=6;const t=a.ColorDef.from(166,221,255);e.view.displayStyle.backgroundColor.setFrom(t),e.view.viewFlags.constructions=!1,e.resetUndo();const n=await e.iModel.executeQuery("SELECT ECInstanceId as id, CodeValue as code, UserLabel as label FROM BisCore.SpatialCategory");for(let o=0;o<n.length;++o)"S-SLAB-CONC"===(n[o].label?n[o].label:n[o].code)&&e.view.changeCategoryDisplay(n[o].id,!1)}),s.SimpleViewerApp.ready.then(e=>{i.render(o.createElement(l.default,{rpcConfig:e}),document.getElementById("root"))})},531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(92),i=n(74),s=n(26),a=n(88),l=n(1064),c=n(1065);l.default();const r=c.default();t.SimpleViewerApp=class SimpleViewerApp extends o.IModelApp{static get ready(){return this._isReady}static onStartup(){const e=new Array;e.push(o.IModelApp.i18n.registerNamespace("SimpleViewer").readFinished),e.push(s.UiCore.initialize(this.i18n)),e.push(a.UiComponents.initialize(this.i18n)),i.Presentation.initialize({activeLocale:o.IModelApp.i18n.languageList()[0]}),this._isReady=Promise.all(e).then(()=>r)}}},585:function(e,t){},587:function(e,t){}},[[521,1,2]]]);
//# sourceMappingURL=main.2fa3dbd6.chunk.js.map